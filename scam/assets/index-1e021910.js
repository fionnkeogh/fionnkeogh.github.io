var ge=Object.defineProperty;var me=(t,e,n)=>e in t?ge(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var U=(t,e,n)=>(me(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function p(){}function de(t){return t()}function ae(){return Object.create(null)}function W(t){t.forEach(de)}function X(t){return typeof t=="function"}function j(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function pe(t){return Object.keys(t).length===0}function we(t){return t&&X(t.destroy)?t.destroy:p}function f(t,e){t.appendChild(e)}function k(t,e,n){t.insertBefore(e,n||null)}function L(t){t.parentNode&&t.parentNode.removeChild(t)}function c(t){return document.createElement(t)}function Z(t){return document.createTextNode(t)}function y(){return Z(" ")}function _e(){return Z("")}function Y(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function h(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function ye(t){return Array.from(t.childNodes)}function ve(t,e){e=""+e,t.data!==e&&(t.data=e)}function se(t,e){t.value=e??""}function x(t,e,n,r){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,r?"important":"")}function ue(t,e){return new t(e)}let ee;function I(t){ee=t}const H=[],le=[];let O=[];const fe=[],be=Promise.resolve();let z=!1;function $e(){z||(z=!0,be.then(ce))}function Q(t){O.push(t)}const V=new Set;let J=0;function ce(){if(J!==0)return;const t=ee;do{try{for(;J<H.length;){const e=H[J];J++,I(e),Se(e.$$)}}catch(e){throw H.length=0,J=0,e}for(I(null),H.length=0,J=0;le.length;)le.pop()();for(let e=0;e<O.length;e+=1){const n=O[e];V.has(n)||(V.add(n),n())}O.length=0}while(H.length);for(;fe.length;)fe.pop()();z=!1,V.clear(),I(t)}function Se(t){if(t.fragment!==null){t.update(),W(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Q)}}function Ce(t){const e=[],n=[];O.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),O=e}const q=new Set;let N;function xe(){N={r:0,c:[],p:N}}function Ne(){N.r||W(N.c),N=N.p}function v(t,e){t&&t.i&&(q.delete(t),t.i(e))}function S(t,e,n,r){if(t&&t.o){if(q.has(t))return;q.add(t),N.c.push(()=>{q.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}function C(t){t&&t.c()}function b(t,e,n){const{fragment:r,after_update:i}=t.$$;r&&r.m(e,n),Q(()=>{const o=t.$$.on_mount.map(de).filter(X);t.$$.on_destroy?t.$$.on_destroy.push(...o):W(o),t.$$.on_mount=[]}),i.forEach(Q)}function $(t,e){const n=t.$$;n.fragment!==null&&(Ce(n.after_update),W(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Ee(t,e){t.$$.dirty[0]===-1&&(H.push(t),$e(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function B(t,e,n,r,i,o,a,u=[-1]){const l=ee;I(t);const s=t.$$={fragment:null,ctx:[],props:o,update:p,not_equal:i,bound:ae(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:ae(),dirty:u,skip_bound:!1,root:e.target||l.$$.root};a&&a(s.root);let m=!1;if(s.ctx=n?n(t,e.props||{},(g,E,...w)=>{const _=w.length?w[0]:E;return s.ctx&&i(s.ctx[g],s.ctx[g]=_)&&(!s.skip_bound&&s.bound[g]&&s.bound[g](_),m&&Ee(t,g)),E}):[],s.update(),m=!0,W(s.before_update),s.fragment=r?r(s.ctx):!1,e.target){if(e.hydrate){const g=ye(e.target);s.fragment&&s.fragment.l(g),g.forEach(L)}else s.fragment&&s.fragment.c();e.intro&&v(t.$$.fragment),b(t,e.target,e.anchor),ce()}I(l)}class F{constructor(){U(this,"$$");U(this,"$$set")}$destroy(){$(this,1),this.$destroy=p}$on(e,n){if(!X(n))return p;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(e){this.$$set&&!pe(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Pe="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Pe);function Te(t){let e,n,r,i,o,a,u;return{c(){e=c("div"),n=c("input"),r=y(),i=c("label"),o=Z(t[2]),h(n,"id",t[1]),h(n,"type","text"),h(n,"inputmode","numeric"),h(n,"pattern","[0-9]*"),x(n,"margin-left","140px"),x(n,"width","40px"),x(n,"box-shadow","none"),x(n,"border-bottom","none"),h(i,"for",t[1]),h(i,"style",t[3]),h(e,"class","input-field col s6")},m(l,s){k(l,e,s),f(e,n),se(n,t[0]),f(e,r),f(e,i),f(i,o),a||(u=[Y(n,"input",t[4]),Y(n,"invalid",t[5])],a=!0)},p(l,[s]){s&2&&h(n,"id",l[1]),s&1&&n.value!==l[0]&&se(n,l[0]),s&4&&ve(o,l[2]),s&2&&h(i,"for",l[1]),s&8&&h(i,"style",l[3])},i:p,o:p,d(l){l&&L(e),a=!1,W(u)}}}function Je(t,e,n){let{id:r}=e,{value:i}=e,{label:o}=e,{style:a=""}=e;function u(){i=this.value,n(0,i)}const l=()=>alert("You must enter only numbers!");return t.$$set=s=>{"id"in s&&n(1,r=s.id),"value"in s&&n(0,i=s.value),"label"in s&&n(2,o=s.label),"style"in s&&n(3,a=s.style)},[i,r,o,a,u,l]}class M extends F{constructor(e){super(),B(this,e,Je,Te,j,{id:1,value:0,label:2,style:3})}}function He(t){let e,n,r,i,o,a,u,l,s,m,g,E,w,_,te,P,ne,D,ie,G,T,re,A,R,K,oe;return u=new M({props:{id:"x",value:Oe,label:"Number of Columns:"}}),s=new M({props:{id:"y",value:We,label:"Number of Rows:"}}),_=new M({props:{id:"macrophages",value:Le,label:"Macrophages:"}}),P=new M({props:{id:"candida",value:Ae,label:"Candida:"}}),T=new M({props:{id:"steps",value:Me,label:"Steps:",style:"padding-left: 170px;"}}),{c(){e=c("main"),n=c("form"),r=c("div"),i=c("h5"),i.textContent="Size of the grid:",o=y(),a=c("div"),C(u.$$.fragment),l=y(),C(s.$$.fragment),m=y(),g=c("h5"),g.textContent="Number of Agents:",E=y(),w=c("div"),C(_.$$.fragment),te=y(),C(P.$$.fragment),ne=y(),D=c("h5"),D.textContent="Number of Steps to Simulate:",ie=y(),G=c("div"),C(T.$$.fragment),re=y(),A=c("div"),A.innerHTML=`<button class="btn waves-effect waves-light" type="submit" name="action">Submit
                <i class="material-icons right">send</i></button>`,h(a,"class","row"),h(w,"class","row"),h(G,"class","row"),h(A,"class","row"),x(A,"margin","10px")},m(d,he){k(d,e,he),f(e,n),f(n,r),f(r,i),f(r,o),f(r,a),b(u,a,null),f(a,l),b(s,a,null),f(r,m),f(r,g),f(r,E),f(r,w),b(_,w,null),f(w,te),b(P,w,null),f(r,ne),f(r,D),f(r,ie),f(r,G),b(T,G,null),f(n,re),f(n,A),R=!0,K||(oe=Y(n,"submit",t[0]),K=!0)},p,i(d){R||(v(u.$$.fragment,d),v(s.$$.fragment,d),v(_.$$.fragment,d),v(P.$$.fragment,d),v(T.$$.fragment,d),R=!0)},o(d){S(u.$$.fragment,d),S(s.$$.fragment,d),S(_.$$.fragment,d),S(P.$$.fragment,d),S(T.$$.fragment,d),R=!1},d(d){d&&L(e),$(u),$(s),$(_),$(P),$(T),K=!1,oe()}}}let Oe=10,We=10,Le=3,Ae=5,Me=100;function Ie(t,e,n){let{openPage:r}=e,{pythonToJS:i}=e;function o(a){a.preventDefault();const u=[[Number(a.target[0].value),Number(a.target[1].value)],Number(a.target[2].value),Number(a.target[3].value),Number(a.target[4].value)];return console.log(u),pyodideGlobals.get("init_simulation")(u[0][0],u[0][1],u[1],u[2],u[3]),r(1),!1}return t.$$set=a=>{"openPage"in a&&n(1,r=a.openPage),"pythonToJS"in a&&n(2,i=a.pythonToJS)},[o,r,i]}class je extends F{constructor(e){super(),B(this,e,Ie,He,j,{openPage:1,pythonToJS:2})}}function ke(t){let e,n,r;return{c(){e=c("canvas"),h(e,"id","view"),x(e,"border-style","solid"),x(e,"border-width","1px"),x(e,"border-color","black")},m(i,o){k(i,e,o),n||(r=we(t[0].call(null,e)),n=!0)},p,i:p,o:p,d(i){i&&L(e),n=!1,r()}}}function Be(t,e,n){let{simulation:r}=e,{pythonToJS:i}=e,{updateSimulation:o}=e;function a(u){const l=initCanvas(),s=l.getContext("2d");loop(s,l);const m=i(r.get_grid_size()),g=new Grid(m.x,m.y,l.width,l.height);console.log(l.width),addCanvasObject(g),l.addEventListener("contextrestored",E=>{o()},!1)}return t.$$set=u=>{"simulation"in u&&n(1,r=u.simulation),"pythonToJS"in u&&n(2,i=u.pythonToJS),"updateSimulation"in u&&n(3,o=u.updateSimulation)},[a,r,i,o]}class Fe extends F{constructor(e){super(),B(this,e,Be,ke,j,{simulation:1,pythonToJS:2,updateSimulation:3})}}function Ge(t){let e,n,r;return n=new Fe({props:{simulation:t[1],pythonToJS:t[0],updateSimulation:t[2]}}),{c(){e=c("main"),C(n.$$.fragment)},m(i,o){k(i,e,o),b(n,e,null),r=!0},p(i,[o]){const a={};o&1&&(a.pythonToJS=i[0]),n.$set(a)},i(i){r||(v(n.$$.fragment,i),r=!0)},o(i){S(n.$$.fragment,i),r=!1},d(i){i&&L(e),$(n)}}}function Re(t,e){clearCanvasMacrophage(),e.forEach(n=>{let r=(window.innerHeight<window.innerWidth?window.innerHeight:window.innerWidth)*.75,i=(window.innerHeight<window.innerWidth?window.innerHeight:window.innerWidth)*.75;addCanvasMacrophages(new Macrophage(n.id,n.x,n.y,r/t.x,i/t.y))})}function qe(t,e){let n=getCanvasCandida();const r=[],i=[];e.forEach(o=>{r.push(o.id)}),n.forEach(o=>{i.push(o.id)}),n.forEach(o=>{r.find(a=>a===o.id)===void 0&&removeCanvasCandida(o)}),e.forEach(o=>{if(i.find(a=>a===o.id)===void 0){let a=(window.innerHeight<window.innerWidth?window.innerHeight:window.innerWidth)*.75,u=(window.innerHeight<window.innerWidth?window.innerHeight:window.innerWidth)*.75;addCanvasCandida(new Candida(o.id,o.x,o.y,a/t.x,u/t.y))}}),n=getCanvasCandida(),n.forEach(o=>{o.update()})}function De(t,e){clearCanvasCytokines();let n=(window.innerHeight<window.innerWidth?window.innerHeight:window.innerWidth)*.75,r=(window.innerHeight<window.innerWidth?window.innerHeight:window.innerWidth)*.75;for(let i=0;i<t.y;i++)for(let o=0;o<t.x;o++){const a=parseFloat(e[`${i}:${o}`][1]),u=e[`${i}:${o}`][0];addCanvasCytokines(new Cytokine(u,o,i,n/t.x,r/t.y,a))}}function Ke(t,e,n){let{openPage:r}=e,{pythonToJS:i}=e;const o=pyodideGlobals.get("get_simulation")();function a(){const u=i(o.get_max_steps());if(i(o.get_current_step())<=u){const s=i(o.run_step()),m=i(o.get_grid_size());Re(m,s.macrophages),qe(m,s.candida),De(m,s.c_grid),console.log(s)}}return t.$$set=u=>{"openPage"in u&&n(3,r=u.openPage),"pythonToJS"in u&&n(0,i=u.pythonToJS)},[i,o,a,r]}class Ue extends F{constructor(e){super(),B(this,e,Ke,Ge,j,{openPage:3,pythonToJS:0})}}function Ve(t){let e,n,r;var i=t[1][t[0]];function o(a,u){return{props:{openPage:a[2],pythonToJS:Ye}}}return i&&(e=ue(i,o(t))),{c(){e&&C(e.$$.fragment),n=_e()},m(a,u){e&&b(e,a,u),k(a,n,u),r=!0},p(a,[u]){if(u&1&&i!==(i=a[1][a[0]])){if(e){xe();const l=e;S(l.$$.fragment,1,0,()=>{$(l,1)}),Ne()}i?(e=ue(i,o(a)),C(e.$$.fragment),v(e.$$.fragment,1),b(e,n.parentNode,n)):e=null}},i(a){r||(e&&v(e.$$.fragment,a),r=!0)},o(a){e&&S(e.$$.fragment,a),r=!1},d(a){a&&L(n),e&&$(e,a)}}}function Ye(t){if(t.toString()!="None")return JSON.parse(t.toString().replaceAll(/'/g,'"'))}function ze(t,e,n){const r=[je,Ue];let i=0;function o(a){return n(0,i=a),i}return[i,r,o]}class Qe extends F{constructor(e){super(),B(this,e,ze,Ve,j,{})}}new Qe({target:document.getElementById("app")});
